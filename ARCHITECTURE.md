# –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ Q-Table Visualizer V2

–í —ç—Ç–æ–º –¥–æ–∫—É–º–µ–Ω—Ç–µ –ø–æ–¥—Ä–æ–±–Ω–æ –æ–ø–∏—Å–∞–Ω–æ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –ø—Ä–æ–µ–∫—Ç–∞, —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤ –∏ –º–µ—Ö–∞–Ω–∏–∑–º—ã –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤.

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```text
v2/
‚îú‚îÄ‚îÄ backend/                # –°–µ—Ä–≤–µ—Ä–Ω–∞—è —á–∞—Å—Ç—å (Python + FastAPI)
‚îÇ   ‚îú‚îÄ‚îÄ core/               # –Ø–¥—Ä–æ –ª–æ–≥–∏–∫–∏ RL
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ agent.py        # –†–µ–∞–ª–∏–∑–∞—Ü–∏—è Q-Learning –∏ SARSA
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ environment.py  # –õ–æ–≥–∏–∫–∞ —Å—Ä–µ–¥—ã (—Å–µ—Ç–∫–∞, –Ω–∞–≥—Ä–∞–¥—ã, –ø–µ—Ä–µ—Ö–æ–¥—ã)
‚îÇ   ‚îú‚îÄ‚îÄ main.py             # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ API –∏ WebSocket
‚îÇ   ‚îú‚îÄ‚îÄ app.py              # –û–±–µ—Ä—Ç–∫–∞ –¥–ª—è –¥–µ—Å–∫—Ç–æ–ø–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (pywebview)
‚îÇ   ‚îî‚îÄ‚îÄ requirements.txt    # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ Python
‚îú‚îÄ‚îÄ frontend/               # –ö–ª–∏–µ–Ω—Ç—Å–∫–∞—è —á–∞—Å—Ç—å (React + TS)
‚îÇ   ‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ components/     # UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã (CanvasGrid, ControlPanel –∏ –¥—Ä.)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ api.ts          # –ö–ª–∏–µ–Ω—Ç—ã –¥–ª—è REST –∏ WebSockets
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ types.ts        # –û–±—â–∏–µ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ App.tsx         # –ì–ª–∞–≤–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ package.json        # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ JS
‚îî‚îÄ‚îÄ build.bat               # –°–∫—Ä–∏–ø—Ç —Å–±–æ—Ä–∫–∏ –¥–ª—è Windows
```

## üß† –Ø–¥—Ä–æ –ª–æ–≥–∏–∫–∏ (Core)

### Environment (`environment.py`)
–°—Ä–µ–¥–∞ —É–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º —Å–µ—Ç–∫–∏ –∏ –ø—Ä–∞–≤–∏–ª–∞–º–∏ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è.
-   **–¢–∏–ø—ã –∫–ª–µ—Ç–æ–∫**: `START`, `TARGET`, `WALL`, `TRAP`, `BONUS`.
-   **–°—Ç—Ä–∞—Ç–µ–≥–∏–∏ –Ω–∞–≥—Ä–∞–¥**:
    -   `minimize_steps`: –®–∞–≥ —Å—Ç–æ–∏—Ç -1.0. –¶–µ–ª—å ‚Äî –∫—Ä–∞—Ç—á–∞–π—à–∏–π –ø—É—Ç—å.
    -   `collect_all`: –®–∞–≥ —Å—Ç–æ–∏—Ç -0.1. –¶–µ–ª—å ‚Äî —Å–æ–±—Ä–∞—Ç—å –≤—Å–µ –±–æ–Ω—É—Å—ã.
-   **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ª–∞–±–∏—Ä–∏–Ω—Ç–∞**: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –∞–ª–≥–æ—Ä–∏—Ç–º Randomized DFS (–ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –æ—Å—Ç–æ–≤–Ω–æ–≥–æ –¥–µ—Ä–µ–≤–∞ –Ω–∞ —Å–µ—Ç–∫–µ —Å –ø–æ—Å–ª–µ–¥—É—é—â–∏–º —É–¥–∞–ª–µ–Ω–∏–µ–º –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Å—Ç–µ–Ω –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø–µ—Ç–µ–ª—å).

### Agent (`agent.py`)
–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ –æ–±—É—á–µ–Ω–∏—è —Å –ø–æ–¥–∫—Ä–µ–ø–ª–µ–Ω–∏–µ–º.
-   **Q-Table**: –°–ª–æ–≤–∞—Ä—å, –≥–¥–µ –∫–ª—é—á–∏ ‚Äî –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã `(x, y)`, –∞ –∑–Ω–∞—á–µ–Ω–∏—è ‚Äî —Å–ª–æ–≤–∞—Ä–∏ –Ω–∞–≥—Ä–∞–¥ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è.
-   **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ Q-Value**:
    -   *Q-Learning*: $Q(s, a) \leftarrow Q(s, a) + \alpha [r + \gamma \max_{a'} Q(s', a') - Q(s, a)]$
    -   *SARSA*: $Q(s, a) \leftarrow Q(s, a) + \alpha [r + \gamma Q(s', a') - Q(s, a)]$
-   **Epsilon-Greedy**: –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å `epsilon` ‚Äî —Å–ª—É—á–∞–π–Ω–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ, –∏–Ω–∞—á–µ ‚Äî –¥–µ–π—Å—Ç–≤–∏–µ —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–º Q.

## üîå –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ (API & WebSockets)

–î–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è "–∂–∏–≤–æ–π" –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≥–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–¥—Ö–æ–¥.

### REST API (HTTP)
–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ä–∞–∑–æ–≤—ã—Ö –∫–æ–º–∞–Ω–¥ –∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:
-   `POST /api/setup`: –ü–æ–ª–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å –Ω–æ–≤—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏.
-   `PUT /api/config`: –ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ (alpha, epsilon) –±–µ–∑ —Å–±—Ä–æ—Å–∞ Q-—Ç–∞–±–ª–∏—Ü—ã.
-   `POST /api/step`: –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –æ–¥–Ω–æ–≥–æ —à–∞–≥–∞.
-   `POST /api/turbo`: –ó–∞–ø—É—Å–∫ –º–∞—Å—Å–æ–≤–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è. –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–æ–≤.

### WebSockets
–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø–æ—Ç–æ–∫–æ–≤–æ–π –ø–µ—Ä–µ–¥–∞—á–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø—Ä–∏ –ø—Ä–æ–∏–≥—Ä—ã–≤–∞–Ω–∏–∏ —Å–∏–º—É–ª—è—Ü–∏–∏:
-   **Update**: –ü–µ—Ä–µ–¥–∞–µ—Ç —Ç–µ–∫—É—â—É—é –ø–æ–∑–∏—Ü–∏—é –∞–≥–µ–Ω—Ç–∞, –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ Q-—Ç–∞–±–ª–∏—Ü–µ (delta) –∏ –ª–æ–∫–∞–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Å—Ä–µ–¥–µ (—Å–±–æ—Ä –±–æ–Ω—É—Å–∞).
-   **Throttle**: –ë—ç–∫–µ–Ω–¥ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç —á–∞—Å—Ç–æ—Ç—É –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π –¥–æ ~30 FPS –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ —Ä–µ—Å—É—Ä—Å–æ–≤ –∏ –ø–ª–∞–≤–Ω–æ—Å—Ç–∏ –æ—Ç—Ä–∏—Å–æ–≤–∫–∏ –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ.

## üé® –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è (Frontend)

### CanvasGrid
–û—Å–Ω–æ–≤–Ω–∞—è –æ—Ç—Ä–∏—Å–æ–≤–∫–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –Ω–∞ HTML5 Canvas. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç:
-   –†–∏—Å–æ–≤–∞—Ç—å —Å–µ—Ç–∫–∏ –ª—é–±–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ (–¥–æ 100x100) –±–µ–∑ –ª–∞–≥–æ–≤ DOM.
-   –û—Ç—Ä–∏—Å–æ–≤—ã–≤–∞—Ç—å —Å—Ç—Ä–µ–ª–∫–∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π (Policy) –∏ —Ç–µ–∫—Å—Ç–æ–≤—ã–µ Q-–∑–Ω–∞—á–µ–Ω–∏—è –ø–æ–≤–µ—Ä—Ö –∫–ª–µ—Ç–æ–∫.
-   –ü–ª–∞–≤–Ω–æ —Ä–µ–Ω–¥–µ—Ä–∏—Ç—å —Ç–µ–ø–ª–æ–∫–∞—Ä—Ç—É, –∏—Å–ø–æ–ª—å–∑—É—è –≥—Ä–∞–¥–∏–µ–Ω—Ç—ã.

### –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤ React
-   `App.tsx` —Ö—Ä–∞–Ω–∏—Ç –∞–∫—Ç—É–∞–ª—å–Ω—É—é Q-—Ç–∞–±–ª–∏—Ü—É –≤ `useRef`, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –ª–∏—à–Ω–∏—Ö —Ä–µ—Ä–µ–Ω–¥–µ—Ä–æ–≤ –ø—Ä–∏ –≤—ã—Å–æ–∫–æ—á–∞—Å—Ç–æ—Ç–Ω—ã—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è—Ö —á–µ—Ä–µ–∑ WebSocket.
-   –°–æ—Å—Ç–æ—è–Ω–∏–µ UI (–∫–Ω–æ–ø–∫–∏, –≥—Ä–∞—Ñ–∏–∫–∏) –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ `useState` —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏.
